# ğŸŒ ISiK EU Profile Comparison Tool

ğŸ‘‰ **[View the Results on GitHub Pages](https://gefyra.github.io/ISiK-EU-Compare)**

---

## ğŸ§¾ Project Purpose

This project provides an automated framework to **compare FHIR profiles** from the German ISiK initiative with corresponding profiles from various **HL7 Europe Implementation Guides (IGs)**. The results are published as a navigable website using **GitHub Pages**.

The goal is to help implementers and standard developers understand structural and semantic differences, align implementations, and support harmonization.

## âš™ï¸ How It Works

The repository defines three GitHub Actions workflows that automate the comparison and deployment:

### ğŸ”„ `main.yml` â€“ Compare & Publish

- Sets up Node and Java
- Installs the FHIR validator CLI via Node helper scripts
- Loads IGs into the local FHIR cache
- Skips comparisons that previously succeeded with unchanged IG versions (configurable via workflow input)
- For each profile pair in the config:
  - Runs structural comparison
  - Saves HTML results in `Comparison/<profile-name>`
  - Creates a central index with links to all comparisons
  - Pushes the output to GitHub Pages
- Preserves earlier results by merging new artifacts with the current `gh-pages` content and deploying with `clean: false`

### ğŸš€ `deploy.yml` â€“ Manual Redeploy

- Restores the currently published comparison results before re-deploying the refreshed `Comparison/` folder and keeps history via `clean: false`

## ğŸ—‚ Configuration

The file [`ComparisonConfig.yml`](.github/config/ComparisonConfig.yml) defines:

- IGs to download:
  ```yaml
  igs:
    - name: hl7.fhir.eu.base
      group: right
    - name: de.gematik.isik
      group: left
  ```

- Profile pairs to compare (auto-generated by `npm run generate-profiles`):
  ```yaml
  profiles:
    - dest: Comparison/EU-Base-location-eu__ISiK-ISiKStandort
      leftIg: de.gematik.isik@5.0.0
      rightIg: hl7.fhir.eu.base@0.1.0
      leftProfile: https://gematik.de/fhir/isik/StructureDefinition/ISiKStandort
      rightProfile: http://hl7.eu/fhir/base/StructureDefinition/location-eu
  ```

Each comparison creates a separate folder with an `index.html` view of the results.

## ğŸ›  Requirements for Local Execution

To run or debug locally:

- Node.js v18
- Java 21
- FHIR Validator CLI (e.g. `org.hl7.fhir.validation.cli-6.4.0.jar`)

### Profile Matrix Generation

After installing IGs locally, run `npm run generate-profiles` to regenerate the `profiles:` matrix in [`ComparisonConfig.yml`](.github/config/ComparisonConfig.yml). The script pairs every right-hand profile with matching resource types from the left-hand IGs.

### Comparison History

Workflow runs automatically persist the outcome and IG versions per comparison in `metadata/comparison-history.json`. New runs only repeat failed comparisons, entries with updated IG versions, or newly added comparisons. Trigger the workflow with the `run_all` input set to `true` if you want to force all comparisons.

## ğŸ“„ License

This project is licensed under the Apache 2.0 License. See the `LICENSE` file for details.
